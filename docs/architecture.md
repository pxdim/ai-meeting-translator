# æ¶æ§‹è¨­è¨ˆ

## ç³»çµ±æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å‰ç«¯ï¼ˆç€è¦½å™¨ï¼‰                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Next.js 15  â”‚  â”‚  å³æ™‚é€å­—ç¨¿   â”‚  â”‚     éŸ³è¨ŠéŒ„è£½          â”‚   â”‚
â”‚  â”‚  + Tailwind  â”‚  â”‚  é¡¯ç¤ºå€       â”‚  â”‚   (MediaRecorder)    â”‚   â”‚
â”‚  â”‚  + shadcn/ui â”‚  â”‚  (é›™èªä¸¦æ’)   â”‚  â”‚                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ WebSocket + REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å¾Œç«¯ï¼ˆRailway é›²ç«¯ï¼‰                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   API ä»£ç†   â”‚  â”‚  WebSocket   â”‚  â”‚    HTTP è·¯ç”±         â”‚   â”‚
â”‚  â”‚  (API é‡‘é‘°)  â”‚  â”‚   è™•ç†å™¨      â”‚  â”‚    (/api/*)          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å¤–éƒ¨ API èˆ‡æœå‹™                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Deepgram   â”‚  â”‚   Gemini     â”‚  â”‚     Supabase         â”‚   â”‚
â”‚  â”‚  èªéŸ³è½‰æ–‡å­—   â”‚  â”‚   ç¿»è­¯+æ‘˜è¦   â”‚  â”‚     PostgreSQL       â”‚   â”‚
â”‚  â”‚  (Nova-2)    â”‚  â”‚  (2.0 Flash) â”‚  â”‚     (é›²ç«¯è³‡æ–™åº«)      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æŠ€è¡“å †ç–Š

### å‰ç«¯
- **æ¡†æ¶**: Next.js 15 (App Router)
- **UI**: Tailwind CSS + shadcn/ui
- **ç‹€æ…‹**: React Hooks
- **å³æ™‚é€šè¨Š**: WebSocket

### å¾Œç«¯
- **åŸ·è¡Œç’°å¢ƒ**: Railway (Node.js)
- **èªè¨€**: TypeScript
- **å³æ™‚é€šè¨Š**: ws (WebSocket)

### å¤–éƒ¨æœå‹™
| æœå‹™ | ç”¨é€” | æ¨¡å‹/ç‰ˆæœ¬ |
|------|------|-----------|
| **Deepgram** | èªéŸ³è¾¨è­˜ | Nova-2 |
| **Google Gemini** | ç¿»è­¯èˆ‡æ‘˜è¦ | gemini-2.0-flash-exp (å…è²») |
| **Supabase** | è³‡æ–™åº« | PostgreSQL 15 |

## éƒ¨ç½²æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Railway å°ˆæ¡ˆ                              â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚   frontend service   â”‚  â”‚   backend service    â”‚            â”‚
â”‚  â”‚   (Next.js)           â”‚  â”‚   (Node.js + WS)      â”‚            â”‚
â”‚  â”‚   Port: 3000          â”‚  â”‚   Port: 3001          â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                 â”‚
â”‚  Environment Variables:                                         â”‚
â”‚  - DEEPGRAM_API_KEY                                            â”‚
â”‚  - GEMINI_API_KEY                                             â”‚
â”‚  - SUPABASE_URL                                               â”‚
â”‚  - SUPABASE_SERVICE_KEY                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Supabase å°ˆæ¡ˆ                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚     meetings         â”‚  â”‚  transcript_segments â”‚            â”‚
â”‚  â”‚     (æœƒè­°è³‡æ–™)        â”‚  â”‚  (é€å­—ç¨¿è³‡æ–™)         â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å‰ç«¯æ¶æ§‹

### é é¢çµæ§‹

```
app/
â”œâ”€â”€ page.tsx              # é¦–é  - éŒ„éŸ³æŒ‰éˆ• + æœ€è¿‘æœƒè­°
â”œâ”€â”€ recording/
â”‚   â””â”€â”€ page.tsx          # éŒ„éŸ³é é¢ - é›™èªé€å­—ç¨¿
â”œâ”€â”€ meeting/
â”‚   â””â”€â”€ [id]/
â”‚       â””â”€â”€ page.tsx      # æœƒè­°è©³æƒ… - å®Œæ•´é€å­—ç¨¿ + ç­†è¨˜
â”œâ”€â”€ history/
â”‚   â””â”€â”€ page.tsx          # æœƒè­°æ­·å²åˆ—è¡¨
â””â”€â”€ settings/
    â””â”€â”€ page.tsx          # è¨­å®šé é¢
```

### çµ„ä»¶çµæ§‹

```
components/
â”œâ”€â”€ RecordingButton.tsx   # éŒ„éŸ³æŒ‰éˆ•
â”œâ”€â”€ TranscriptDisplay.tsx # é›™èªé€å­—ç¨¿é¡¯ç¤º
â”œâ”€â”€ MeetingCard.tsx       # æœƒè­°å¡ç‰‡
â””â”€â”€ ui/                   # shadcn/ui åŸºç¤çµ„ä»¶
```

## å¾Œç«¯æ¶æ§‹

### æ¨¡çµ„çµæ§‹

```
src/
â”œâ”€â”€ server.ts             # ä¸»ä¼ºæœå™¨å…¥å£
â”œâ”€â”€ websocket/
â”‚   â””â”€â”€ handler.ts        # WebSocket è™•ç†å™¨
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ deepgram.ts       # Deepgram API æ•´åˆ
â”‚   â””â”€â”€ gemini.ts         # Gemini API æ•´åˆ
â”œâ”€â”€ db/
â”‚   â””â”€â”€ supabase.ts       # Supabase å®¢æˆ¶ç«¯
â””â”€â”€ storage/
    â””â”€â”€ recordings/       # éŒ„éŸ³æª”æ¡ˆ
```

## WebSocket é€šè¨Šå”å®š

### å®¢æˆ¶ç«¯ â†’ ä¼ºæœå™¨

```typescript
// é–‹å§‹éŒ„éŸ³
{ type: 'start_recording', meetingId: string }

// éŸ³è¨Šè³‡æ–™ (äºŒé€²åˆ¶)
ArrayBuffer

// åœæ­¢éŒ„éŸ³
{ type: 'stop_recording' }
```

### ä¼ºæœå™¨ â†’ å®¢æˆ¶ç«¯

```typescript
// ç‹€æ…‹æ›´æ–°
{ type: 'status', status: 'connected' | 'disconnected' }

// é€å­—ç¨¿æ›´æ–°
{
  type: 'transcript',
  segment: {
    id: string,
    startTime: number,
    endTime: number,
    text: { zh: string, en: string },
    confidence: number
  }
}

// æœƒè­°å®Œæˆ
{
  type: 'meeting_complete',
  meetingId: string,
  summary: string,
  actionItems: string[]
}
```

## è³‡æ–™æ¨¡å‹

### Supabase è³‡æ–™è¡¨

```sql
-- meetings è¡¨
CREATE TABLE meetings (
  id TEXT PRIMARY KEY,
  title TEXT DEFAULT 'æœƒè­°è¨˜éŒ„',
  created_at TIMESTAMPTZ DEFAULT NOW(),
  duration INTEGER DEFAULT 0,
  audio_path TEXT NOT NULL,
  summary TEXT,
  action_items TEXT  -- JSON array
);

-- transcript_segments è¡¨
CREATE TABLE transcript_segments (
  id TEXT PRIMARY KEY,
  meeting_id TEXT NOT NULL,
  start_time REAL NOT NULL,
  end_time REAL NOT NULL,
  text_zh TEXT NOT NULL,      -- ä¸­æ–‡é€å­—ç¨¿
  text_en TEXT NOT NULL,      -- è‹±æ–‡ç¿»è­¯
  confidence REAL NOT NULL,
  speaker TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  FOREIGN KEY (meeting_id) REFERENCES meetings(id) ON DELETE CASCADE
);
```

## API æ•´åˆ

### Deepgram (èªéŸ³è¾¨è­˜)

- **ç«¯é»**: wss://api.deepgram.com/v1/listen
- **æ¨¡å‹**: nova-2
- **èªè¨€**: zh-CN (ä¸»è¦)
- **å»¶é²**: < 300ms
- **è²»ç”¨**: $0.009/åˆ†é˜

### Google Gemini (ç¿»è­¯èˆ‡æ‘˜è¦)

| åŠŸèƒ½ | æ¨¡å‹ | é€Ÿåº¦ | æˆæœ¬ |
|------|------|------|------|
| å³æ™‚ç¿»è­¯ | gemini-2.0-flash-exp | âš¡ æœ€å¿« | å…è²» |
| æœƒè­°æ‘˜è¦ | gemini-1.5-pro | ğŸ¢ ä¸­ç­‰ | ä½ |

### Supabase (è³‡æ–™åº«)

- **è³‡æ–™åº«**: PostgreSQL 15
- **é€£ç·š**: Supabase Client SDK
- **å…è²»å±¤**: 500MB è³‡æ–™åº«å„²å­˜
- **å»¶é²**: < 100ms (æ±å—äºå€åŸŸ)

## æˆæœ¬ä¼°ç®—

| é …ç›® | æ¯æœˆæˆæœ¬ |
|------|----------|
| Railway (å‰ç«¯+å¾Œç«¯) | $5-20 |
| Deepgram (20å°æ™‚) | ~$11 |
| Gemini (ç¿»è­¯+æ‘˜è¦) | $0 (å…è²»é¡åº¦å…§) |
| Supabase (å…è²»å±¤) | $0 |
| **ç¸½è¨ˆ** | **ç´„ $16-31/æœˆ** |
